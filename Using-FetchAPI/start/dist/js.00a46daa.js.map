{"version":3,"sources":["js/Http.js","js/index.js"],"names":["Http","constructor","uri","xhr","XMLHttpRequest","serialize","obj","qs","prop","encodeURIComponent","join","errorHandler","res","ok","Error","error","get","path","fetch","then","post","data","req","Request","method","body","headers","delete","id","Promise","resolve","reject","addEventListener","status","statusText","open","send","_default","exports","default","_Http","_interopRequireDefault","require","__esModule","container","document","querySelector","total","addProductForm","http","Row","product","price","render","arr","elems","map","e","totalCost","reduce","prev","curr","Number","innerHTML","loadAndRender","response","json","alert","preventDefault","target","elements","value","JSON","stringify","getAttribute"],"mappings":"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","file":"js.00a46daa.js","sourceRoot":"..\\src","sourcesContent":["class Http {\n  constructor(uri) {\n    this.uri = uri;\n    this.xhr = new XMLHttpRequest();\n  }\n  static serialize(obj) {\n    let qs = [];\n    for (let prop in obj) {\n      qs = [\n        ...qs,\n        `${encodeURIComponent(prop)}=${encodeURIComponent(obj[prop])}`,\n      ];\n    }\n    return qs.join(\"&\");\n  }\n\n  static errorHandler(res) {\n    if (!res.ok) throw new Error(res.error);\n    return res;\n  }\n  get(path = \"\", qs) {\n    return fetch(`${this.uri}${path}/?${Http.serialize(qs)}`).then(\n      this.errorHandler\n    );\n  }\n\n  post(path = \"\", data) {\n    const req = new Request(`${this.uri}${path}`, {\n      method: \"POST\",\n      body: data,\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n\n    return fetch(req).then(this.errorHandler);\n  }\n  delete(id) {\n    return new Promise((resolve, reject) => {\n      this.xhr.addEventListener(\"load\", function () {\n        resolve({ status: this.statusText });\n      });\n      this.xhr.addEventListener(\"error\", (error) => reject(error));\n      this.xhr.open(\"DELETE\", `${this.uri}/${id}`, true);\n      this.xhr.send();\n    });\n  }\n}\n\nexport default Http;\n","// Write your code here...\nimport Http from \"./Http\";\nconst container = document.querySelector(\".list\");\nconst total = document.querySelector(\".total\");\nconst addProductForm = document.querySelector(\"form[name=add-product]\");\nconst http = new Http(\"http://localhost:3000/products\");\n\nconst Row = ({ product, price, id }) =>\n  `<div class=\"product\">\n    <span class=\"prod-name\">${product}</span>\n    <span class=\"prod-cost\">$${price}</span>\n    <div class=\"delete-btn\"><a href=\"#\" name=\"delete-btn\" data-id=\"${id}\">X</a></div>\n  </div>`;\n\nconst render = function (arr) {\n  const elems = arr.map((e) => Row(e));\n  const totalCost = arr.reduce((prev, curr) => prev + Number(curr.price), 0);\n\n  container.innerHTML = elems.join(\"\");\n  total.innerHTML = Row({ product: \"TOTAL\", price: totalCost });\n};\n\nasync function loadAndRender() {\n  try {\n    const response = await http.get();\n    const json = await response.json();\n    render(json);\n  } catch {\n    alert(\"There was an error talking to the server!\");\n  }\n}\n\nloadAndRender();\n\n// Add product and reload\naddProductForm.addEventListener(\"submit\", async function (e) {\n  e.preventDefault();\n  let product = e.target.elements.product;\n  let price = e.target.elements.price;\n  try {\n    if (product.value !== \"\" && price.value !== 0) {\n      await http.post(\n        JSON.stringify(\"/\", {\n          product: product.value,\n          price: Number(price.value),\n        })\n      );\n      loadAndRender();\n    }\n  } catch {\n    alert(\"There was an error storing data\");\n  } finally {\n    product.value = \"\";\n    price.value = 0;\n  }\n});\n\ncontainer.addEventListener(\"click\", async function (e) {\n  e.preventDefault();\n  if (e.target.getAttribute(\"name\") === \"delete-btn\") {\n    let id = e.target.getAttribute(\"data-id\");\n    try {\n      await http.delete(id);\n      loadAndRender();\n    } catch {\n      alert(\"There was an error deleting data\");\n    }\n  }\n});\n"]}